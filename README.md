![](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/Assets/Microsoft_logo.png)

## About the repository
The goal of this repository is to use the Kaggle "Microsoft Malware Prediction competition" data and apply data science techniques to predict if a machine will have malware. The bigger challenges on this competition are the huge dataset, and finding ways to run it on Kaggle kernel, Google colab or on a local machine (Memory issues), and also the high number of features.

### Our team published Kaggle kernels:
- [Malware Detection - EDA and LGBM](https://www.kaggle.com/dimitreoliveira/malware-detection-eda-and-lgbm)
- [Malware Detection - Extended EDA](https://www.kaggle.com/dimitreoliveira/malware-detection-extended-eda)
- [Microsoft Malware Prediction - EDA with Tableau](https://www.kaggle.com/tatianass/microsoft-malware-prediction-eda-with-tableau)
- [Malware Prediction - Adversarial Validation](https://www.kaggle.com/tatianass/malware-prediction-adversarial-validation)

### What you will find
- Deep_learning [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/tree/master/Deep_learning)
  - Tensorflow model (Estimator API) [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/Deep_learning/model.py)
  - End-to-end model with Tensorflow [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/Deep_learning/main.py)
- Documentation [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/tree/master/Documentation)
   - Project working cycle and effort, relevant content and insights [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/Documentation/Planning.md)
- EDA [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/tree/master/EDA)
  - Analysis of Train Dataset Distribution [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/EDA/Analysis%20of%20Train%20Dataset%20Distribution.twb)
  - Analysis of the Distribution Between Test and Train [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/EDA/Analysis%20of%20the%20Distribution%20Between%20Test%20and%20Train.twb)
  - Encoding evaluation with datasets distribution [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/EDA/Encoding%20evaluation%20with%20datasets%20distribution.ipynb)
  - Encoding for binary features [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/EDA/Encoding%20for%20binary%20features.ipynb)
  - Encoding for features with high cardinality [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/EDA/Encoding%20for%20features%20with%20high%20cardinality.ipynb)
  - Encoding for features with low cardinality [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/EDA/Encoding%20for%20features%20with%20low%20cardinality.ipynb)
  - Malware Detection - EDA and LGBM [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/EDA/Malware%20Detection%20-%20EDA%20and%20LGBM.ipynb)
  - Malware Detection - Extended EDA [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/EDA/Malware%20Detection%20-%20Extended%20EDA.ipynb)
  - Feature type and cardinality [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/EDA/Malware%20Prediction%20-%20Feature%20type%20and%20cardinality.ipynb)
  - Missing study (high) [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/EDA/Malware%20Prediction%20-%20Missing%20study%20(high).ipynb)
  - Missing study (low) [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/EDA/Malware%20Prediction%20-%20Missing%20study%20(low).ipynb)
  - Version and Build features [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/EDA/Malware%20Prediction%20-%20Version%20and%20Build%20features.ipynb)
  - Binary features EDA [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/EDA/Malware%20prediction%20-%20Binary%20features%20EDA.ipynb)
  - Numerical features EDA [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/EDA/Malware%20prediction%20-%20Numerical%20features%20EDA.ipynb)
  - Train validation split [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/EDA/Train%20validation%20split%20-%20Malware%20Prediction.ipynb)
- Model backlog [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/tree/master/Model%20backlog)
  - Models generated on Google colab [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/tree/master/Model%20backlog/Google%20colab)
  - Models generated on Kaggle [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/tree/master/Model%20backlog/Kaggle)
  - Model backlog [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/Model%20backlog/Model%20backlog.md)
- Utils [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/tree/master/Utils)
  - Auxiliary script to merge data sets [[link]](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/Utils/Train%20and%20Test%20union.py)

### Microsoft Malware Prediction
#### Can you predict if a machine will soon be hit with malware?

Kaggle competition: https://www.kaggle.com/c/microsoft-malware-prediction
Our insights are [here.](https://github.com/dimitreOliveira/MicrosoftMalwarePrediction/blob/master/Documentation/Planning.md)

### Overview
The malware industry continues to be a well-organized, well-funded market dedicated to evading traditional security measures. Once a computer is infected by malware, criminals can hurt consumers and enterprises in many ways.

With more than one billion enterprise and consumer customers, Microsoft takes this problem very seriously and is deeply invested in improving security.

As one part of their overall strategy for doing so, Microsoft is challenging the data science community to develop techniques to predict if a machine will soon be hit with malware. As with their previous, Malware Challenge (2015), Microsoft is providing Kagglers with an unprecedented malware dataset to encourage open-source progress on effective techniques for predicting malware occurrences.

Can you help protect more than one billion machines from damage BEFORE it happens?

### Acknowledgments
This competition is hosted by Microsoft, Windows Defender ATP Research, Northeastern University College of Computer and Information Science, and Georgia Tech Institute for Information Security & Privacy.

### Dependencies by folder:
- General
  - [Python 3.x](https://www.python.org/)
  - [Pandas](http://pandas.pydata.org/)
  - [NumPy](http://www.numpy.org/)
- Deep_learning
  - [Tensorflow](https://www.tensorflow.org/)
  - [Sklearn](https://scikit-learn.org/stable/)
- EDA
  - [Seaborn](https://seaborn.pydata.org/)
  - [Matplotlib](http://matplotlib.org/)
  - [Category Encoders](http://contrib.scikit-learn.org/categorical-encoding/)
  - [Dask](https://dask.org/)
  - [Plotly](https://plot.ly/python/)
  - [LightGBM](https://lightgbm.readthedocs.io/en/latest/index.html)
- Model backlog
  - Google colab
    - [Seaborn](https://seaborn.pydata.org/)
    - [Matplotlib](http://matplotlib.org/)
    - [Sklearn](https://scikit-learn.org/stable/)
    - [Keras](https://keras.io/)
    - [Tensorflow](https://www.tensorflow.org/)
  - Kaggle
    - [Seaborn](https://seaborn.pydata.org/)
    - [Matplotlib](http://matplotlib.org/)
    - [Category Encoders](http://contrib.scikit-learn.org/categorical-encoding/)
    - [Dask](https://dask.org/)
    - [Sklearn](https://scikit-learn.org/stable/)
    - [CatBoost](https://catboost.ai/)
    - [XGBoost](https://xgboost.readthedocs.io/en/latest/index.html)
    - [LightGBM](https://lightgbm.readthedocs.io/en/latest/index.html)
    
### TODO (in case anyone wants to continue this work):
- The Tensorflow End-to-end part was stopped for taking too much effort, I was able to iterate faster with Keras, but it may be a good option for longer training using neural networks.
- Try model staking, it may help with predictions but will need different training and validation of the models.
- Features like AvSigVersion and OSBuild may be mapped to datetime, as was pointed by other competitors, then you create a timeline, this may help with train/validation splits.
- Try Dimensionality reduction on high cardinality features, techniques like PCA, t-SNE or auto encoders may help.
- Other approaches to parameter tunning like Bayesian optimization may help as well.
- Techniques of model explainability like SHAP or ELI5 may help to finetune models.
